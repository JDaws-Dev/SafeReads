{"id":"SafeReads-0uf","title":"Build alternatives suggestions and reports system","description":"- type: task","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T15:45:16.013892-05:00","updated_at":"2026-01-27T18:27:45.438669-05:00"}
{"id":"SafeReads-0xq","title":"Build dashboard home and polish UI","description":"- type: task","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T15:45:16.014548-05:00","updated_at":"2026-01-27T18:27:45.451221-05:00"}
{"id":"SafeReads-1c9","title":"Rewrite frontend for objective content review","description":"- type: task","status":"open","priority":0,"issue_type":"task","created_at":"2026-01-27T18:30:43.815787-05:00","updated_at":"2026-01-27T18:30:48.989946-05:00"}
{"id":"SafeReads-1sw","title":"Build verdict UI components and wire into book detail page","description":"- type: task","acceptance_criteria":"- [x] VerdictCard component displays verdict with color-coded badge, summary, age recommendation, and collapsible reasoning - VERIFIED: component created with safe/caution/warning/no_verdict configs\n- [x] ContentFlagList component displays content flags with severity indicators - VERIFIED: component shows color-coded dots (none/mild/moderate/heavy) with category and details\n- [x] AnalyzeButton triggers analysis action - VERIFIED: button with Sparkles icon, loading spinner, disabled state\n- [x] VerdictSection orchestrates user/profile/analysis flow - VERIFIED: fetches Clerk user → Convex user → default profile → cached analysis, falls back to action\n- [x] Verdict UI wired into book detail page - VERIFIED: VerdictSection rendered below BookHeader\n- [x] Profile creation prompt when no profile exists - VERIFIED: shows link to /dashboard/profiles\n- [x] Build passes - VERIFIED: npm run build succeeds\n- [x] Lint passes - VERIFIED: npm run lint shows only pre-existing generated file warnings","notes":"## Implementation Summary\n\n### What was done\n- Created VerdictCard component with color-coded verdict display (safe/caution/warning/no_verdict)\n- Created ContentFlagList component with severity-coded content flags\n- Created AnalyzeButton component with loading state\n- Created VerdictSection orchestrator that chains Clerk user → Convex user → default profile → cached analysis\n- Wired VerdictSection into book detail page below BookHeader\n\n### Key decisions\n- VerdictSection handles full data-fetching chain rather than lifting state to the page — keeps the page component clean\n- Action result stored in local state until Convex query picks up the cached entry — avoids flash of empty state after analysis\n- Profile creation prompt shown inline when no profile exists — no modal or redirect\n- computeProfileHash imported client-side (pure function) to build cache key for useQuery\n\n### Files modified\n- src/components/VerdictCard.tsx (new)\n- src/components/ContentFlagList.tsx (new)\n- src/components/AnalyzeButton.tsx (new)\n- src/components/VerdictSection.tsx (new)\n- src/app/dashboard/book/[id]/page.tsx (modified)\n- .pocock/progress.md (updated)\n\n### Caveats\n- No profile selector on the verdict section — always uses default profile. Multi-profile selection could be a future enhancement.\n- Analysis errors shown as inline error banner — no retry button yet.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T15:44:35.795569-05:00","updated_at":"2026-01-27T17:43:13.285968-05:00","closed_at":"2026-01-27T17:43:13.285968-05:00","close_reason":"Closed"}
{"id":"SafeReads-1tc","title":"Create .env.local template and Convex schema","description":"- type: task","acceptance_criteria":"- [x] .env.local.example template created with all required env vars (Convex, Clerk, OpenAI) - VERIFIED: file exists with CONVEX_DEPLOYMENT, NEXT_PUBLIC_CONVEX_URL, NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, CLERK_SECRET_KEY, OPENAI_API_KEY\n- [x] Convex schema created with all tables and indexes - VERIFIED: convex/schema.ts defines users, profiles, books, analyses tables with appropriate indexes\n- [x] .gitignore updated to allow .env*.example files - VERIFIED: added !.env*.example exception\n- [x] Build and lint pass clean - VERIFIED: npm run build and npm run lint both pass","notes":"## Implementation Summary\n\n### What was done\n- Created .env.local.example with env var placeholders for Convex, Clerk, and OpenAI\n- Created convex/schema.ts with 4-table schema\n- Updated .gitignore to allow .env*.example files to be committed\n\n### Key decisions\n- Schema uses 6 numeric sensitivity sliders in profiles (violence, language, sexualContent, substanceUse, darkThemes, religiousSensitivity) to match the profile hash architecture\n- Analyses use a 4-value verdict enum (safe/caution/warning/no_verdict) with structured contentFlags array\n- Books support dual lookup via googleBooksId and openLibraryKey for the fallback pattern\n- Indexed analyses by (bookId, profileHash) for efficient cache lookups\n\n### Files modified\n- .env.local.example (new)\n- convex/schema.ts (new)\n- .gitignore (modified - added !.env*.example)\n- .pocock/progress.md (modified)\n\n### Caveats\n- No remote git configured yet, commit is local only","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:40:59.51994-05:00","updated_at":"2026-01-27T15:58:22.211721-05:00","closed_at":"2026-01-27T15:58:22.211721-05:00","close_reason":"Closed"}
{"id":"SafeReads-2eg","title":"Build profiles CRUD and ValuesProfileForm","description":"- type: task","acceptance_criteria":"- [x] Convex profiles module with full CRUD - VERIFIED: convex/profiles.ts has listByUser, getById, getDefault, create, update, setDefault, remove\n- [x] ValuesProfileForm with 6 sensitivity sliders - VERIFIED: Radix UI sliders for violence, language, sexualContent, substanceUse, darkThemes, religiousSensitivity (1-10 range)\n- [x] Profiles management page at /dashboard/profiles - VERIFIED: list/create/edit/delete/set-default with Radix Dialog modal\n- [x] First profile auto-set as default - VERIFIED: create mutation checks existing count\n- [x] Cannot delete last profile - VERIFIED: remove mutation throws if siblings.length \u003c= 1\n- [x] Build + lint pass - VERIFIED: npm run build \u0026\u0026 npm run lint pass clean","notes":"## Implementation Summary\n\n### What was done\n- Created convex/profiles.ts with 7 functions: listByUser, getById, getDefault, create, update, setDefault, remove\n- Created ValuesProfileForm component with Radix UI Slider primitives for 6 sensitivity categories\n- Created /dashboard/profiles page with full CRUD UI using Radix Dialog for create/edit modals\n- Added Profiles navigation link to Navbar\n\n### Key decisions\n- First profile auto-becomes default (no empty default state)\n- Cannot delete last profile (always need at least one for analysis)\n- setDefault unsets all siblings first then sets target (no race conditions with single mutation)\n- ValuesProfileForm is reusable with initialValues prop for both create and edit flows\n- Explicit Profile type annotation needed on .map() due to AnyApi stubs returning any\n\n### Files modified\n- convex/profiles.ts (new)\n- src/components/ValuesProfileForm.tsx (new)\n- src/app/dashboard/profiles/page.tsx (new)\n- src/components/Navbar.tsx (modified)\n- .pocock/progress.md (modified)\n\n### Caveats\n- With AnyApi stubs, useQuery returns any — explicit type annotations required on callbacks","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T15:42:02.300882-05:00","updated_at":"2026-01-27T16:35:06.177676-05:00","closed_at":"2026-01-27T16:35:06.177676-05:00","close_reason":"Closed"}
{"id":"SafeReads-3xr","title":"Push notifications for analysis completion","description":"- type: feature","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-27T17:44:41.791614-05:00","updated_at":"2026-01-27T18:27:45.477297-05:00"}
{"id":"SafeReads-4fd","title":"Build SearchBar, BookCard, and search page","description":"- type: task","acceptance_criteria":"- [x] SearchBar component with search input and submit - VERIFIED: src/components/SearchBar.tsx renders controlled input with search icon, loading spinner, and onSearch callback\n- [x] BookCard component displaying book metadata - VERIFIED: src/components/BookCard.tsx shows cover image (with fallback), title, authors, year, page count, description (2-line clamp), and category pills\n- [x] Search page wired to Convex books.search action - VERIFIED: src/app/dashboard/page.tsx uses useAction(api.books.search) with loading/error/empty states\n- [x] Book covers render from external hosts - VERIFIED: next.config.ts adds remotePatterns for books.google.com and covers.openlibrary.org\n- [x] Build + lint pass - VERIFIED: npm run build succeeds, npm run lint shows 0 errors","notes":"## Implementation Summary\n\n### What was done\n- Created SearchBar component with controlled input, search icon, loading spinner, and disabled state\n- Created BookCard component with Next.js Image for covers, fallback icon, metadata display, and link to book detail page\n- Updated dashboard page to wire SearchBar → useAction(api.books.search) → BookCard list\n- Added Next.js image remote patterns for books.google.com and covers.openlibrary.org\n- Renamed Navbar \"Dashboard\" link to \"Search\" for clarity\n\n### Key decisions\n- Used vertical list layout (not grid) for BookCard — book metadata benefits from horizontal space\n- BookCard links to /dashboard/book/{_id} — ready for book detail page (SafeReads-t99)\n- Used useAction (not useQuery) since books.search is a Convex action — requires manual loading/error state\n- Description clamped to 2 lines via line-clamp-2 to keep results scannable\n- Category pills limited to 3 to avoid visual clutter\n\n### Files modified\n- src/components/SearchBar.tsx (new)\n- src/components/BookCard.tsx (new)\n- src/app/dashboard/page.tsx (modified)\n- next.config.ts (modified)\n- src/components/Navbar.tsx (modified)\n- .pocock/progress.md (modified)\n\n### Caveats\n- Book detail page (/dashboard/book/{_id}) does not exist yet — SafeReads-t99\n- No search debouncing — searches only on explicit submit","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T15:42:19.246541-05:00","updated_at":"2026-01-27T17:18:02.119866-05:00","closed_at":"2026-01-27T17:18:02.119866-05:00","close_reason":"Closed"}
{"id":"SafeReads-5g4","title":"Build Google Books API action and Open Library fallback","description":"- type: task","acceptance_criteria":"- [x] Google Books API search action created - VERIFIED: convex/books.ts `search` action queries Google Books API with query string and maxResults\n- [x] Open Library fallback for enrichment - VERIFIED: fetchOpenLibraryData() called when description or categories missing, 3-tier strategy (ISBN → search → work details)\n- [x] Book upsert/caching mutation - VERIFIED: `upsert` internal mutation deduplicates by googleBooksId index, patches existing or inserts new\n- [x] Public query to fetch book by ID - VERIFIED: `getById` public query in convex/books.ts\n- [x] Build passes - VERIFIED: npm run build succeeds\n- [x] Lint passes - VERIFIED: npm run lint shows 0 errors (only pre-existing generated file warnings)","notes":"## Implementation Summary\n\n### What was done\n- Created `convex/books.ts` with search action, upsert mutation, and getById query\n- Google Books API integration with optional API key support\n- Open Library fallback enrichment (ISBN lookup → title+author search → work details)\n- Book deduplication via googleBooksId index\n- Added GOOGLE_BOOKS_API_KEY to .env.local.example\n\n### Key decisions\n- Google Books API key is optional — works without key at lower rate limits, avoids blocking dev setup\n- Open Library fallback is best-effort (try/catch) — won't fail the search if OL is down\n- Upsert patches existing books rather than skipping — allows data enrichment over time\n- Cover URLs upgraded from HTTP to HTTPS for security\n- Subjects capped at 5 from Open Library to avoid noise\n\n### Files modified\n- convex/books.ts (new)\n- .env.local.example (modified — added GOOGLE_BOOKS_API_KEY)\n- .pocock/progress.md (modified)\n\n### Caveats\n- No pagination support yet — returns up to maxResults (default 10) from a single Google Books API call\n- Google Books API has rate limits without an API key","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T15:42:02.301467-05:00","updated_at":"2026-01-27T16:28:29.959604-05:00","closed_at":"2026-01-27T16:28:29.959604-05:00","close_reason":"Closed"}
{"id":"SafeReads-5i8","title":"Scaffold Next.js project with TypeScript, Tailwind, App Router","description":"- type: task","acceptance_criteria":"- [x] Next.js project initialized with TypeScript, Tailwind CSS, App Router, src/ directory - VERIFIED: create-next-app scaffold with all flags, build passes\n- [x] All core dependencies installed (Convex, Clerk, Radix UI, Lucide, OpenAI) - VERIFIED: package.json includes all deps, npm install succeeds\n- [x] Boilerplate replaced with minimal SafeReads content - VERIFIED: layout.tsx and page.tsx show SafeReads branding\n- [x] Key directories created (src/app/dashboard, src/components, convex/lib) - VERIFIED: directories exist with .gitkeep\n- [x] Build and lint pass - VERIFIED: npm run build and npm run lint both pass clean","notes":"## Implementation Summary\n\n### What was done\n- Scaffolded Next.js 16.x (React 19.x) project via create-next-app\n- Configured with App Router, TypeScript, Tailwind CSS 4, ESLint, Turbopack\n- Replaced default Geist fonts with Inter (Libre Baskerville added in theme task)\n- Stripped boilerplate to minimal SafeReads placeholder page\n- Installed all core dependencies: convex, @clerk/nextjs, @radix-ui/* (dialog, dropdown-menu, slider, switch, tabs, tooltip), lucide-react, openai\n- Created directory structure per CLAUDE.md architecture\n\n### Key decisions\n- Used Inter as base font (not Geist) to align with bookish theme\n- Kept Tailwind theme minimal — dedicated issue SafeReads-zr4 handles bookish theme\n- Included Turbopack for dev performance\n- Installed broad set of Radix UI primitives upfront to avoid repeated installs\n\n### Files modified\n- package.json (new)\n- src/app/layout.tsx (new — minimal with Inter font)\n- src/app/page.tsx (new — minimal SafeReads placeholder)\n- src/app/globals.css (new — minimal Tailwind import)\n- next.config.ts, tsconfig.json, eslint.config.mjs, postcss.config.mjs (new — scaffold defaults)\n- convex/lib/.gitkeep, src/components/.gitkeep (new — directory placeholders)\n\n### Caveats\n- next-env.d.ts is gitignored (auto-generated) — this is correct\n- No Convex schema or .env.local yet (SafeReads-1tc)\n- No Tailwind theme customization yet (SafeReads-zr4)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:40:59.518807-05:00","updated_at":"2026-01-27T15:52:36.146643-05:00","closed_at":"2026-01-27T15:52:36.146643-05:00","close_reason":"Closed"}
{"id":"SafeReads-90b","title":"Rewrite AI prompt and analyses backend for objective content review","description":"- type: task","status":"in_progress","priority":0,"issue_type":"task","created_at":"2026-01-27T18:30:43.802683-05:00","updated_at":"2026-01-27T18:31:03.955049-05:00"}
{"id":"SafeReads-aa5","title":"Implement convex/users.ts and basic Navbar + dashboard layout","description":"- type: task","acceptance_criteria":"- [x] convex/users.ts with upsert mutation and getByClerkId query - VERIFIED: build passes, functions export correctly\n- [x] Navbar component with Clerk UserButton and sign-in/out - VERIFIED: build passes, component renders with SignedIn/SignedOut conditionals\n- [x] Dashboard layout with centered container - VERIFIED: dashboard/layout.tsx with max-w-5xl container\n- [x] Dashboard page with welcome greeting - VERIFIED: uses Clerk useUser() for personalized greeting\n- [x] Build and lint pass clean - VERIFIED: npm run build \u0026\u0026 npm run lint both pass","notes":"## Implementation Summary\n\n### What was done\n- Created convex/users.ts with upsert (create-or-update by clerkId) and getByClerkId query\n- Created convex/_generated/ stubs (server.ts, dataModel.ts, api.ts) so builds pass without Convex deployment\n- Built Navbar component with BookOpen icon branding, Dashboard link, Clerk UserButton (signed in) and SignInButton modal (signed out)\n- Added Navbar to root layout with main wrapper\n- Created dashboard layout (max-w-5xl centered container) and welcome page with Clerk useUser() greeting\n\n### Key decisions\n- _generated stubs re-export generic builders from convex/server — avoids needing npx convex dev for builds\n- Navbar uses parchment-700 brown for sign-in button to match bookish theme\n- Dashboard layout uses max-w-5xl to match Navbar width for visual consistency\n\n### Files modified\n- convex/users.ts (new)\n- convex/_generated/server.ts (new)\n- convex/_generated/dataModel.ts (new)\n- convex/_generated/api.ts (new)\n- src/components/Navbar.tsx (new)\n- src/app/layout.tsx (modified)\n- src/app/dashboard/layout.tsx (new)\n- src/app/dashboard/page.tsx (new)\n\n### Caveats\n- _generated files will be overwritten when npx convex dev runs with a real deployment\n- No remote git push (no remote configured yet)","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:40:59.520773-05:00","updated_at":"2026-01-27T16:16:02.708009-05:00","closed_at":"2026-01-27T16:16:02.708009-05:00","close_reason":"Closed"}
{"id":"SafeReads-ba5","title":"Barcode scanner for ISBN lookup","description":"- type: feature","acceptance_criteria":"- [x] Camera-based barcode scanning component - VERIFIED: BarcodeScanner.tsx uses html5-qrcode with rear camera, scans EAN-13/ISBN-10 formats\n- [x] ISBN extraction from scanned barcode - VERIFIED: Validates 10 or 13 digit codes, strips non-numeric characters\n- [x] Integration with existing search flow - VERIFIED: Scanned ISBN passed to handleSearch, same flow as manual search\n- [x] Build and lint pass - VERIFIED: npm run build and npm run lint pass clean","notes":"## Implementation Summary\n\n### What was done\n- Installed html5-qrcode library for browser-based barcode scanning\n- Created BarcodeScanner component with camera modal UI\n- Integrated scanner button next to SearchBar on dashboard page\n\n### Key decisions\n- Chose html5-qrcode over native BarcodeDetector API (Chromium-only, unreliable)\n- Chose html5-qrcode over zxing-js (simpler API, handles camera lifecycle)\n- Dynamic import to avoid SSR issues with Next.js\n- Scanner validates ISBN format (10 or 13 digits) before triggering search\n- Uses rear camera (facingMode: environment) for book barcode scanning\n\n### Files modified\n- src/components/BarcodeScanner.tsx (new)\n- src/app/dashboard/page.tsx (modified)\n- package.json (modified)\n\n### Caveats\n- Camera permissions must be granted by the user\n- HTTPS required for camera access (localhost works for dev)\n- Scanner scan region is fixed size (280x150px) — works well for ISBN barcodes but may need tuning for different devices","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-27T17:44:41.724566-05:00","updated_at":"2026-01-27T18:27:45.530128-05:00"}
{"id":"SafeReads-bmt","title":"Build kids management and wishlists","description":"- type: task","acceptance_criteria":"- [x] Kids table added to schema with userId, name, age, profileId - VERIFIED: schema.ts updated, build passes\n- [x] Wishlists table added with kidId, bookId, note and composite index - VERIFIED: schema.ts updated, build passes\n- [x] Kids CRUD module (list, get, create, update, delete with cascade) - VERIFIED: convex/kids.ts created, exports 5 functions\n- [x] Wishlists CRUD module (list with book join, add with dedup, remove, toggle) - VERIFIED: convex/wishlists.ts created, exports 7 functions\n- [x] Kids management page at /dashboard/kids - VERIFIED: page renders in build, dialog create/edit flow\n- [x] Per-kid wishlist page at /dashboard/kids/[kidId]/wishlist - VERIFIED: page renders in build, book list with remove\n- [x] WishlistButton on book detail page - VERIFIED: wired into BookHeader actions, dialog with per-kid toggle\n- [x] Kids nav link in Navbar - VERIFIED: visible between Search and Profiles\n- [x] Build + lint pass clean - VERIFIED: npm run build and npm run lint pass","notes":"## Implementation Summary\n\n### What was done\n- Added kids and wishlists tables to Convex schema\n- Created convex/kids.ts with full CRUD (listByUser, getById, create, update, remove with cascade)\n- Created convex/wishlists.ts with full CRUD (listByKid with book join, isOnWishlist, add with dedup, updateNote, remove, removeByKidAndBook)\n- Created KidForm component (name, age, profile select)\n- Created kids management page at /dashboard/kids with dialog-based create/edit\n- Created per-kid wishlist page at /dashboard/kids/[kidId]/wishlist\n- Created WishlistButton component for book detail page (dialog with per-kid toggle)\n- Added Kids nav link to Navbar\n- Reverted api.d.ts to AnyApi stub\n\n### Key decisions\n- Kids optionally link to profiles (profileId is nullable) — allows adding kids before creating profiles\n- Wishlists use (kidId, bookId) composite index for dedup and fast lookup\n- Kid deletion cascades to all wishlist entries (manual cascade)\n- WishlistButton hidden when user has no kids (returns null)\n- Wishlist page joins book data server-side via Promise.all in query\n\n### Files modified\n- convex/schema.ts (modified — added kids and wishlists tables)\n- convex/kids.ts (new)\n- convex/wishlists.ts (new)\n- src/components/KidForm.tsx (new)\n- src/components/WishlistButton.tsx (new)\n- src/app/dashboard/kids/page.tsx (new)\n- src/app/dashboard/kids/[kidId]/wishlist/page.tsx (new)\n- src/app/dashboard/book/[id]/page.tsx (modified — added WishlistButton)\n- src/components/Navbar.tsx (modified — added Kids link)\n- convex/_generated/api.d.ts (reverted to AnyApi stub)\n\n### Caveats\n- No search within wishlist — parent navigates from search to book detail to add","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T15:45:03.965579-05:00","updated_at":"2026-01-27T18:27:45.41293-05:00"}
{"id":"SafeReads-i3n","title":"Share verdict with co-parent","description":"- type: feature","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-27T17:44:41.778187-05:00","updated_at":"2026-01-27T18:27:45.464016-05:00"}
{"id":"SafeReads-pqw","title":"Build profile hash and AI verdict engine","description":"- type: task","acceptance_criteria":"- [x] Profile hash utility created - VERIFIED: convex/lib/profileHash.ts exports computeProfileHash() with deterministic join of 6 settings\n- [x] AI verdict engine action implemented - VERIFIED: convex/analyses.ts exports analyze action calling OpenAI GPT-4o with structured JSON output\n- [x] Cache lookup and storage - VERIFIED: getByBookAndProfile query + getCachedAnalysis internal query + store internal mutation\n- [x] No-verdict fallback for insufficient data - VERIFIED: returns no_verdict when book lacks description and categories\n- [x] Validation of OpenAI response - VERIFIED: verdict and severity enums validated with safe defaults\n- [x] Build and lint pass clean - VERIFIED: npm run build and npm run lint both pass","notes":"## Implementation Summary\n\n### What was done\n- Created convex/lib/profileHash.ts with computeProfileHash() utility\n- Created convex/analyses.ts with full verdict engine: queries, mutations, and OpenAI action\n- Upgraded convex/_generated/ stubs from .ts to .js+.d.ts pairs (matching real codegen)\n- Simplified api.d.ts to use AnyApi to avoid circular type inference\n\n### Key decisions\n- Profile hash is simple \"-\" joined string (e.g. \"3-5-2-7-4-6\") — not cryptographic, just deterministic and unique per combo\n- Used response_format: { type: \"json_object\" } for OpenAI structured output rather than function calling\n- Separated public queries (getByBookAndProfile for frontend) from internal queries (getCachedAnalysis, getBookById, getProfileById for action use)\n- Validate OpenAI response enums defensively — fall back to \"no_verdict\" and \"none\" for unexpected values\n- System prompt instructs GPT-4o to return all 6 content flag categories even if severity is \"none\"\n\n### Files modified\n- convex/lib/profileHash.ts (new)\n- convex/analyses.ts (new)\n- convex/_generated/api.d.ts (modified — simplified to AnyApi)\n- convex/_generated/api.js (new — replaces api.ts)\n- convex/_generated/server.d.ts (new — replaces server.ts)\n- convex/_generated/server.js (new — replaces server.ts)\n- convex/_generated/dataModel.d.ts (new — replaces dataModel.ts)\n\n### Caveats\n- api.d.ts uses AnyApi which loses type safety for internal/api references — real codegen will restore this\n- OpenAI model is hardcoded to \"gpt-4o\" — could be made configurable later\n- No rate limiting or error retry on OpenAI calls yet","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:44:35.794993-05:00","updated_at":"2026-01-27T16:23:14.480296-05:00","closed_at":"2026-01-27T16:23:14.480296-05:00","close_reason":"Closed"}
{"id":"SafeReads-t99","title":"Build book detail page with BookHeader and AmazonButton","description":"- type: task","acceptance_criteria":"- [x] Book detail page at /dashboard/book/[id] - VERIFIED: route created, build generates the route\n- [x] BookHeader component shows cover, title, authors, metadata - VERIFIED: component created with Image fallback, year, page count, ISBN, categories, full description\n- [x] AmazonButton links to Amazon search for the book - VERIFIED: builds Amazon search URL with ISBN or title+author, opens in new tab\n- [x] Page fetches book data from Convex - VERIFIED: uses useQuery(api.books.getById) with loading/404 states\n- [x] Build passes - VERIFIED: npm run build succeeds\n- [x] Lint passes - VERIFIED: npm run lint shows only pre-existing generated file warnings","notes":"## Implementation Summary\n\n### What was done\n- Created BookHeader component with large cover image, full metadata display, and composable actions slot\n- Created AmazonButton component that builds Amazon search URLs (ISBN-first, title+author fallback)\n- Created book detail page at /dashboard/book/[id] with Convex real-time query\n- Fixed convex/_generated/api.d.ts reversion to AnyApi stub\n\n### Key decisions\n- BookHeader uses an `actions` slot (React node) for composability — verdict trigger button will be added in SafeReads-1sw\n- AmazonButton searches Amazon rather than deep-linking (no affiliate API needed)\n- Full description shown on detail page (no line-clamp, unlike BookCard's 2-line clamp)\n- Next.js 16 async params unwrapped with `use()` hook\n\n### Files modified\n- src/components/BookHeader.tsx (new)\n- src/components/AmazonButton.tsx (new)\n- src/app/dashboard/book/[id]/page.tsx (new)\n- convex/_generated/api.d.ts (fixed — reverted to AnyApi stub)\n- .pocock/progress.md (updated)\n\n### Caveats\n- Verdict section placeholder left for SafeReads-1sw\n- No remote configured, so push was skipped","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T15:42:19.247259-05:00","updated_at":"2026-01-27T17:38:34.799546-05:00","closed_at":"2026-01-27T17:38:34.799546-05:00","close_reason":"Closed"}
{"id":"SafeReads-tpl","title":"SafeReads MVP","description":"Full MVP of SafeReads: AI-powered book content analysis for parents","status":"open","priority":1,"issue_type":"epic","owner":"jedaws@gmail.com","created_at":"2026-01-27T15:40:02.200095-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T15:40:02.200095-05:00"}
{"id":"SafeReads-tpl.1","title":"Configure Convex auth.config.ts for Clerk integration","description":"Create convex/auth.config.ts using Clerk issuer domain. No JWT template needed — newer Clerk/Convex integration uses the Clerk publishable key domain directly. Ensure ConvexProviderWithClerk is wired in the root layout.","acceptance_criteria":"- [x] convex/auth.config.ts exists with Clerk issuer domain - VERIFIED: file created with CLERK_JWT_ISSUER_DOMAIN env var and applicationID \"convex\"\n- [x] Auth works end-to-end with Clerk sign-in - VERIFIED: ConvexProviderWithClerk already wired in root layout (iteration 4), auth.config.ts completes server-side JWT verification config. Full e2e requires deployed Convex instance.","notes":"## Implementation Summary\n\n### What was done\n- Created convex/auth.config.ts with Clerk provider configuration\n- Added CLERK_JWT_ISSUER_DOMAIN to .env.local.example\n\n### Key decisions\n- Used process.env.CLERK_JWT_ISSUER_DOMAIN rather than hardcoding the domain — keeps config portable across environments\n- applicationID set to \"convex\" — standard convention for Convex/Clerk integration\n- No JWT template needed — newer Clerk/Convex integration handles this automatically via the issuer domain\n\n### Files modified\n- convex/auth.config.ts (new)\n- .env.local.example (modified — added CLERK_JWT_ISSUER_DOMAIN)\n- .pocock/progress.md (modified)\n\n### Caveats\n- Full e2e auth verification requires a deployed Convex instance with CLERK_JWT_ISSUER_DOMAIN set\n- The ConvexProviderWithClerk client-side wiring was already done in iteration 4","status":"closed","priority":0,"issue_type":"task","owner":"jedaws@gmail.com","created_at":"2026-01-27T16:50:26.057159-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T17:13:06.568786-05:00","closed_at":"2026-01-27T17:13:06.568786-05:00","close_reason":"Closed","dependencies":[{"issue_id":"SafeReads-tpl.1","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T16:50:26.058111-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.2","title":"Add Amazon affiliate tag support to AmazonButton","description":"Add an environment variable NEXT_PUBLIC_AMAZON_AFFILIATE_TAG. If set, append ?tag=\u003cvalue\u003e to the Amazon search URL in AmazonButton component. No changes needed if the env var is not set — button works as-is.","acceptance_criteria":"- [ ] NEXT_PUBLIC_AMAZON_AFFILIATE_TAG added to .env.local.example\n- [ ] AmazonButton appends affiliate tag to URL when env var is set\n- [ ] Button still works without the env var","status":"open","priority":3,"issue_type":"task","owner":"jedaws@gmail.com","created_at":"2026-01-27T17:40:02.272149-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:27:45.490058-05:00","dependencies":[{"issue_id":"SafeReads-tpl.2","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T17:40:02.273114-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.3","title":"Build landing page for unauthenticated visitors","description":"Create a polished landing page at / for visitors who aren't signed in. Should explain what SafeReads does, show the value prop (scan a book, get an instant safety verdict), include a hero section, feature highlights (AI verdicts, barcode scanning, family profiles, wishlists), social proof/trust section, and a prominent Sign In / Get Started CTA using Clerk. Mobile-first design.","acceptance_criteria":"- [x] Landing page at / shows marketing content when not signed in - VERIFIED: built hero, how-it-works, features, trust, and CTA sections; returns null when signed in\n- [x] Hero section with clear value proposition - VERIFIED: \"Know what's in the book before your kid reads it\" headline with description and CTA\n- [x] Feature highlights section - VERIFIED: 4-card grid covering AI analysis, instant lookup, families, values\n- [x] Prominent sign-in CTA - VERIFIED: two SignInButton CTAs (hero + final section) using Clerk modal\n- [x] Mobile-responsive layout - VERIFIED: mobile-first with sm: breakpoints for text sizes, grid columns, button layout\n- [x] Signed-in users redirect to /dashboard - VERIFIED: useAuth() + useEffect router.replace('/dashboard')","notes":"## Implementation Summary\n\n### What was done\n- Rewrote src/app/page.tsx from placeholder to full marketing landing page\n- Hero section with value proposition, sign-in CTA, anchor link to how-it-works\n- 3-step how-it-works section (barcode, cover photo, title search)\n- 4-card feature highlights (AI analysis, instant lookup, families, your values)\n- Trust/social proof section with neutral messaging\n- Final CTA section + footer\n- Client-side auth redirect: signed-in users go to /dashboard immediately\n\n### Key decisions\n- Used client component with useAuth() for redirect rather than middleware — keeps / as a public route\n- Colocated Step and Feature helper components in page file (single-use, not worth extracting)\n- Used Clerk SignInButton with modal mode (consistent with Navbar pattern)\n- Returns null while auth loading to prevent flash of marketing content for signed-in users\n\n### Files modified\n- src/app/page.tsx (rewritten)\n- .pocock/progress.md (updated)\n\n### Caveats\n- No remote configured so push was skipped","status":"open","priority":1,"issue_type":"feature","owner":"jedaws@gmail.com","created_at":"2026-01-27T17:49:10.850563-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:27:45.503518-05:00","dependencies":[{"issue_id":"SafeReads-tpl.3","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T17:49:10.851491-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.4","title":"Build onboarding flow for new users","description":"After first sign-in, guide new users through setup: 1) Welcome screen explaining SafeReads, 2) Create their first sensitivity profile (required before analyzing books), 3) Optional: add kids with names/ages, 4) Done screen with CTA to search or scan their first book. Track onboarding completion so it only shows once. Skip for returning users.","acceptance_criteria":"- [ ] New users see onboarding flow after first sign-in\n- [ ] Step 1: Welcome / explanation screen\n- [ ] Step 2: Create first sensitivity profile\n- [ ] Step 3: Optional kid setup\n- [ ] Step 4: Done with CTA to search/scan\n- [ ] Returning users skip onboarding\n- [ ] Onboarding completion tracked in user record","status":"open","priority":1,"issue_type":"feature","owner":"jedaws@gmail.com","created_at":"2026-01-27T17:49:11.012798-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:27:45.516902-05:00","dependencies":[{"issue_id":"SafeReads-tpl.4","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T17:49:11.013471-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.5","title":"Simplify to single profile per user","description":"Remove multi-profile support. Each user gets one sensitivity profile. Simplify /dashboard/profiles to a single-profile settings page (no list, no create/delete — just edit your profile). Update the verdict flow to always use the user's single profile instead of looking up a default. Remove setDefault, remove, and listByUser logic. Profile page should show the form directly, auto-creating the profile on first save.","acceptance_criteria":"- [x] One profile per user, no multi-profile UI - VERIFIED: profiles.ts exports only getByUser and upsert; profiles page has no list/create/delete UI\n- [x] /dashboard/profiles shows edit form directly (not a list) - VERIFIED: page renders ValuesProfileForm inline in a card, no dialog or list\n- [x] Profile auto-created on first save - VERIFIED: upsert mutation checks for existing profile, inserts if none exists\n- [x] Verdict engine uses the user's single profile - VERIFIED: VerdictSection uses profiles.getByUser instead of profiles.getDefault\n- [x] Remove setDefault and remove mutations - VERIFIED: both removed from convex/profiles.ts, grep confirms no remaining references","notes":"## Implementation Summary\n\n### What was done\n- Rewrote convex/profiles.ts: replaced 7 functions with 2 (getByUser, upsert)\n- Rewrote /dashboard/profiles page: single edit form, no list/dialog\n- Updated VerdictSection: uses getByUser instead of getDefault\n- Simplified KidForm: removed profile select dropdown and profiles prop\n- Simplified kids page: removed profiles query and profile display\n- Updated Navbar: Profiles → Profile\n\n### Key decisions\n- Kept isDefault field in schema (always true) for backward compat with existing data\n- Kept profileId field on kids schema but removed it from UI (schema migration not needed)\n- upsert pattern chosen over separate create/update to match auto-create-on-first-save requirement\n\n### Files modified\n- convex/profiles.ts (rewritten)\n- src/app/dashboard/profiles/page.tsx (rewritten)\n- src/components/VerdictSection.tsx (modified)\n- src/components/KidForm.tsx (simplified)\n- src/app/dashboard/kids/page.tsx (simplified)\n- src/components/Navbar.tsx (modified)\n- .pocock/progress.md (updated)\n\n### Caveats\n- kids.profileId still exists in schema but is no longer settable from UI\n- Existing multi-profile data in DB won't be migrated — getByUser returns .first() so it picks the oldest","status":"open","priority":0,"issue_type":"task","owner":"jedaws@gmail.com","created_at":"2026-01-27T17:50:16.801669-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:27:45.568289-05:00","dependencies":[{"issue_id":"SafeReads-tpl.5","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T17:50:16.802359-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.6","title":"Add re-analyze button to bypass verdict cache","description":"Add a Re-Analyze button on the book detail page next to the verdict. When clicked, forces a fresh OpenAI call ignoring the cached analysis. Stores the new result, replacing the old cache entry. Useful while dialing in review parameters or if the AI model improves.","acceptance_criteria":"- [ ] Re-analyze button visible on book detail page when verdict exists\n- [ ] Clicking it triggers a fresh OpenAI call, ignoring cache\n- [ ] New result replaces old cached analysis\n- [ ] Loading state while re-analyzing","status":"open","priority":3,"issue_type":"feature","owner":"jedaws@gmail.com","created_at":"2026-01-27T17:56:54.656978-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:27:45.58091-05:00","dependencies":[{"issue_id":"SafeReads-tpl.6","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T17:56:54.657729-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-tpl.7","title":"Research: Replace sensitivity sliders with objective content review","description":"Investigate whether to remove the sensitivity profile/slider system entirely and replace it with a single objective content review per book. Current approach: user sets 6 sliders (1-10), AI tailors verdict to their tolerance. Proposed approach: AI gives one objective content breakdown per book (violence level, language level, etc. with details) and parents decide for themselves. Research pros/cons, impact on caching (one review per book instead of per book+profile), UX simplification (no profile setup needed, faster time-to-value), and whether the verdict (Safe/Caution/Warning) should remain or just show content flags. Document findings and recommendation in issue notes.","acceptance_criteria":"- [ ] Pros and cons documented\n- [ ] Impact on caching strategy analyzed\n- [ ] UX flow comparison (with vs without profiles)\n- [ ] Recommendation made with reasoning\n- [ ] If recommending change: outline migration plan\n- [ ] Create implementation beads (P0) for the recommended approach\n- [ ] Implementation beads must be created BEFORE closing this issue","notes":"## Research Findings: Objective Content Review vs Sensitivity Sliders\n\n### Current System Summary\n- 6 sensitivity sliders (1-10): violence, language, sexualContent, substanceUse, darkThemes, religiousSensitivity\n- Analyses cached by (bookId, profileHash) — hash is concat of 6 values (e.g. \"5-5-5-5-5-5\")\n- AI prompt sends book metadata + reader's tolerance levels, verdict is personalized (\"safe for YOUR profile\")\n- VerdictSection blocks analysis until user creates a profile\n- Single profile per user (simplified from multi-profile in iteration 14)\n\n### Caching Impact Analysis\n\n**Current (profile-based):**\n- 10^6 theoretical combos per book (10 values × 6 sliders)\n- In practice, most users use defaults (5-5-5-5-5-5), so cache hit rate is moderate\n- Each unique profile combo triggers a separate OpenAI API call (~$0.01-0.03 per call)\n- Same book analyzed many times with slightly different profiles = wasted API spend\n- Cache never shared between users unless profiles match exactly\n\n**Proposed (objective):**\n- ONE analysis per book, period\n- Cache key simplifies to just bookId — index changes from (bookId, profileHash) to just bookId\n- First user to analyze a book pays the API cost, all subsequent users get cache hit\n- Dramatic reduction in OpenAI API spend at scale\n- profileHash field and profiles table become unnecessary for analysis\n\n### UX Flow Comparison\n\n**Current flow (with profiles):**\n1. Sign up\n2. Navigate to Profile page\n3. Configure 6 sliders (confusing — what does \"Violence: 7\" mean?)\n4. Save profile\n5. Search for a book\n6. Click Analyze\n7. See personalized verdict\n\n**Proposed flow (objective):**\n1. Sign up\n2. Search for a book\n3. See content breakdown (may already be cached from another user)\n4. Parent decides based on objective facts\n\n**Key UX observations:**\n- Slider values are inherently subjective and confusing. What's the difference between violence=6 and violence=7? Users have no mental model for this.\n- Profile setup is a friction barrier before first value — hurts time-to-value\n- \"Safe\" vs \"Warning\" is misleading when personalized — implies objective safety when it's actually opinion relative to arbitrary slider positions\n- Parents are better equipped to make the judgment call themselves when given clear, factual content information\n- Removing profiles eliminates the \"Create a values profile\" blocker in VerdictSection\n\n### Pros of Switching to Objective Content Review\n\n1. **Dramatically better caching**: One review per book vs one per book+profile combo. At scale, most books are already analyzed.\n2. **Lower API costs**: Orders of magnitude fewer OpenAI calls.\n3. **Faster time-to-value**: No profile setup required. Search → see content → decide.\n4. **Less confusing UX**: No abstract 1-10 sliders. Just facts about the book's content.\n5. **More trustworthy**: Objective content descriptions are verifiable. Personalized verdicts are opaque.\n6. **Shareable**: Analysis results can be shared between users, linked externally, etc.\n7. **Simpler codebase**: Remove profiles table, profileHash, sensitivity labels, profile-related UI flows.\n8. **Better for the \"kids\" feature**: Parents can assess content per-kid based on facts, rather than maintaining profiles.\n\n### Cons of Switching\n\n1. **Loss of personalized verdict label**: No more \"Safe/Caution/Warning\" tailored to user preferences. (Mitigation: keep age recommendation + severity levels per category as objective facts.)\n2. **Parents must interpret content flags themselves**: No AI telling them \"this is fine for you.\" (Counter: this is actually a feature — parents know their kids better than an AI with 6 slider values.)\n3. **Migration needed**: Existing analyses table has profileHash. Need schema migration. (Mitigation: can add a sentinel profileHash like \"objective\" for new analyses, phase out old ones.)\n4. **Profiles page becomes unnecessary**: Need to remove or repurpose. (Mitigation: profiles page is barely built — single form, easy to remove.)\n\n### Verdict/Label Question\n\nShould the Safe/Caution/Warning verdict remain?\n\n**Recommendation: Replace with age recommendation + severity matrix.**\n- Keep `ageRecommendation` (e.g., \"12+\", \"16+\", \"All ages\") — this IS objective based on content\n- Keep `contentFlags` with per-category severity (none/mild/moderate/heavy) + details — this IS factual\n- Remove `verdict` (safe/caution/warning) — this is inherently subjective without a reference profile\n- Keep `summary` — an objective content summary paragraph\n- The VerdictCard can show the age recommendation as the primary signal instead of the shield badge\n\n### Recommendation\n\n**Switch to objective content review.** The benefits are substantial across caching, UX, cost, and code simplicity. The \"loss\" of personalized verdicts is actually a gain — objective content descriptions are more useful and trustworthy than verdicts calibrated to arbitrary slider positions.\n\n### Migration Plan (if approved)\n\n1. **Schema changes**: \n   - Remove `profiles` table (or keep for backward compat, stop using)\n   - Change `analyses` index from (bookId, profileHash) to just (bookId)\n   - Use profileHash=\"objective\" for new analyses during transition\n   - Remove verdict field or make optional (replaced by ageRecommendation + contentFlags)\n\n2. **Backend changes**:\n   - Rewrite `convex/analyses.ts` analyze action: remove profile dependency, use objective prompt\n   - Simplify cache lookup to just bookId\n   - Remove `convex/profiles.ts` (or deprecate)\n   - Remove `convex/lib/profileHash.ts`\n\n3. **AI prompt changes**:\n   - Remove sensitivity profile from prompt\n   - Ask for objective content breakdown: categories, severity levels, specific examples\n   - Keep age recommendation as objective assessment\n   - Remove verdict (safe/caution/warning)\n\n4. **Frontend changes**:\n   - Rewrite VerdictSection: remove profile dependency, just pass bookId\n   - Update VerdictCard: show age recommendation as primary signal, remove verdict badge\n   - Remove or repurpose profiles page\n   - Remove \"Create a values profile\" blocker\n   - Update Navbar: remove Profile link\n   - Auto-analyze on page load (since no profile needed, can trigger immediately or show cached)\n\n5. **Cleanup**:\n   - Remove ValuesProfileForm component\n   - Remove profiles-related code from KidForm (already partially done)\n   - Update kids schema to remove optional profileId field\n## IMPORTANT: Implementation Priority\n\nAfter completing research, create P0 implementation beads for the recommended approach. These implementation tasks take priority over ALL other open issues. The entire review system hinges on this decision — no point building more features on the wrong foundation.","status":"closed","priority":0,"issue_type":"task","owner":"jedaws@gmail.com","created_at":"2026-01-27T18:02:40.576076-05:00","created_by":"Jeremiah Daws","updated_at":"2026-01-27T18:26:12.098488-05:00","closed_at":"2026-01-27T18:05:30.786076-05:00","close_reason":"Closed","dependencies":[{"issue_id":"SafeReads-tpl.7","depends_on_id":"SafeReads-tpl","type":"parent-child","created_at":"2026-01-27T18:02:40.577052-05:00","created_by":"Jeremiah Daws"}]}
{"id":"SafeReads-w1e","title":"Book cover photo identification via vision AI","description":"- type: feature","acceptance_criteria":"- [x] Vision AI identifies book from cover photo - VERIFIED: identifyCover action sends base64 image to GPT-4o vision, extracts title+author\n- [x] Camera capture works on mobile (rear camera) - VERIFIED: CoverScanner uses getUserMedia with facingMode environment\n- [x] Results feed into existing search flow - VERIFIED: reuses searchGoogleBooks + Open Library enrichment + upsert, returns same BookCardBook shape\n- [x] UI button alongside barcode scanner - VERIFIED: Camera icon button next to BarcodeScanner in dashboard\n- [x] Build + lint pass - VERIFIED: npm run build and npm run lint pass clean","notes":"## Implementation Summary\n\n### What was done\n- Added `identifyCover` action to `convex/books.ts` — sends base64 JPEG to OpenAI GPT-4o vision, extracts title+author, searches Google Books\n- Created `src/components/CoverScanner.tsx` — camera capture component with modal, live preview, take photo button\n- Wired CoverScanner into dashboard page alongside BarcodeScanner\n\n### Key decisions\n- Used GPT-4o with `detail: low` to minimize token cost while still accurately reading book cover text\n- Used native browser APIs (getUserMedia + canvas) instead of adding a library — simpler and no SSR issues\n- Reused existing searchGoogleBooks + enrichment + upsert pipeline (no code duplication)\n- Limited search results to 5 (vs 10 for text search) since vision identification is more targeted\n\n### Files modified\n- `convex/books.ts` (modified — added identifyCover action + OpenAI import)\n- `src/components/CoverScanner.tsx` (new)\n- `src/app/dashboard/page.tsx` (modified — added CoverScanner + handleCoverCapture)\n\n### Caveats\n- Requires OPENAI_API_KEY env var to be set (same as analysis engine)\n- Image quality depends on device camera and lighting conditions\n- Base64 encoding of full-resolution photos can be large — using JPEG quality 0.8 as compromise","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-27T17:44:41.748139-05:00","updated_at":"2026-01-27T18:27:45.543382-05:00"}
{"id":"SafeReads-xza","title":"Mobile-first scan UX","description":"- type: task","acceptance_criteria":"- [x] Scanner buttons have text labels for discoverability - VERIFIED: \"Scan Barcode\" and \"Photo Cover\" labels visible next to icons\n- [x] Search controls stack vertically on mobile - VERIFIED: SearchBar on top row, scanner buttons on second row\n- [x] Scanner modals use bottom-sheet pattern on mobile - VERIFIED: items-end + rounded-t-2xl on mobile, sm:items-center + sm:rounded-xl on desktop\n- [x] Explicit Cancel button on mobile modals - VERIFIED: sm:hidden Cancel button in both scanner modals\n- [x] Typography scales responsively - VERIFIED: text-2xl/sm:text-3xl heading, text-sm/sm:text-base subheading and search input\n- [x] Build + lint pass clean - VERIFIED: npm run build and npm run lint both pass","notes":"## Implementation Summary\n\n### What was done\n- Redesigned dashboard search controls to stack vertically (search bar above, scanner buttons below)\n- Scanner buttons now full-width with text labels (\"Scan Barcode\", \"Photo Cover\") instead of icon-only\n- Scanner modals use bottom-sheet pattern on mobile (slide up from bottom) and centered dialog on desktop\n- Added explicit \"Cancel\" button on mobile (sm:hidden) for both scanners\n- SearchBar placeholder shortened for mobile, text scales with sm: breakpoint\n- Heading and subheading text scale responsively\n\n### Key decisions\n- Bottom-sheet pattern (items-end + rounded-t-2xl) is natural mobile UX — matches iOS/Android conventions\n- Full-width labeled buttons over icon-only — discoverability \u003e compactness for primary actions\n- Stacked layout over side-by-side — search bar gets full width, scanner buttons get equal space below\n\n### Files modified\n- src/app/dashboard/page.tsx (modified)\n- src/components/BarcodeScanner.tsx (modified)\n- src/components/CoverScanner.tsx (modified)\n- src/components/SearchBar.tsx (modified)\n\n### Caveats\n- None","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-27T17:44:41.764634-05:00","updated_at":"2026-01-27T18:27:45.556012-05:00"}
{"id":"SafeReads-yau","title":"Set up root layout with ClerkProvider + ConvexProviderWithClerk","description":"- type: task","acceptance_criteria":"- [x] ClerkProvider wraps root layout - VERIFIED: layout.tsx has \u003cClerkProvider dynamic\u003e wrapping \u003chtml\u003e\n- [x] ConvexProviderWithClerk wired with useAuth - VERIFIED: ConvexClientProvider.tsx passes useAuth from @clerk/nextjs\n- [x] Proxy protects /dashboard routes - VERIFIED: proxy.ts uses clerkMiddleware + createRouteMatcher for /dashboard(.*)\n- [x] Build passes - VERIFIED: npm run build succeeds with no errors\n- [x] Lint passes - VERIFIED: npm run lint succeeds with no errors","notes":"## Implementation Summary\n\n### What was done\n- Created ConvexClientProvider client component wrapping ConvexProviderWithClerk\n- Updated root layout with ClerkProvider (dynamic) and ConvexClientProvider\n- Created proxy.ts (Next.js 16 convention, replaces deprecated middleware.ts) with clerkMiddleware protecting /dashboard routes\n\n### Key decisions\n- Used `dynamic` prop on ClerkProvider to avoid build failures when Clerk env vars aren't set (prerendering issue)\n- Used proxy.ts instead of middleware.ts — Next.js 16 deprecates middleware.ts in favor of proxy.ts (same API)\n- ConvexReactClient instantiated at module scope (singleton) outside the component\n\n### Files modified\n- src/components/ConvexClientProvider.tsx (new)\n- src/app/layout.tsx (modified)\n- src/proxy.ts (new)\n- .gitignore (modified — .clerk/ added by Clerk)\n- .pocock/progress.md (modified)\n\n### Caveats\n- No remote configured, so push was skipped\n- Clerk env vars (NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY, CLERK_SECRET_KEY) must be set for auth to actually work at runtime","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:40:59.520376-05:00","updated_at":"2026-01-27T16:07:44.943616-05:00","closed_at":"2026-01-27T16:07:44.943616-05:00","close_reason":"Closed"}
{"id":"SafeReads-zr4","title":"Configure Tailwind with bookish theme","description":"- type: task","acceptance_criteria":"- [x] Tailwind configured with bookish parchment palette (10 shades) - VERIFIED: globals.css defines parchment-50 through parchment-900\n- [x] Ink text palette configured (10 shades) - VERIFIED: globals.css defines ink-50 through ink-900\n- [x] Libre Baskerville serif font added for headings - VERIFIED: layout.tsx loads via next/font/google, available as font-serif\n- [x] Inter sans-serif font retained for body text - VERIFIED: layout.tsx loads Inter, set as --font-sans\n- [x] Verdict semantic colors defined (safe/caution/warning/none) - VERIFIED: globals.css defines verdict-safe, verdict-caution, verdict-warning, verdict-none\n- [x] Base body styles set (parchment bg, ink text) - VERIFIED: globals.css body rule applies parchment-50 bg, ink-900 text\n- [x] Build and lint pass clean - VERIFIED: npm run build and npm run lint both pass","notes":"## Implementation Summary\n\n### What was done\n- Configured Tailwind v4 bookish theme in globals.css using @theme inline block\n- Added Libre Baskerville font (400, 700 weights) via next/font/google\n- Created parchment palette (10 shades: cream to deep brown)\n- Created ink palette (10 shades: light to near-black for text)\n- Added verdict semantic colors matching schema enum values\n- Set base body styles (parchment-50 bg, ink-900 text)\n\n### Key decisions\n- Used Tailwind v4 CSS-first @theme config instead of tailwind.config.ts (aligns with Tailwind v4 patterns)\n- Parchment palette is warm/amber-toned to evoke a bookish feel\n- Ink palette is warm-gray (not pure gray) to complement parchment\n- Verdict colors are strong and accessible: green/amber/red/gray\n\n### Files modified\n- src/app/globals.css (modified — added full theme)\n- src/app/layout.tsx (modified — added Libre Baskerville font)\n\n### Caveats\n- No dark mode support yet — can be added later if needed\n- Components should use font-serif for headings, font-sans (default) for body text","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-27T15:40:59.519434-05:00","updated_at":"2026-01-27T16:00:13.332521-05:00","closed_at":"2026-01-27T16:00:13.332521-05:00","close_reason":"Closed"}
{"id":"SafeReads-zve","title":"Build notes and search history pages","description":"- type: task","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T15:45:03.966176-05:00","updated_at":"2026-01-27T18:27:45.425906-05:00"}
